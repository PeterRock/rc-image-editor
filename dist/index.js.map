{"version":3,"file":"index.js","sources":["../src/LoadingMask/index.js","../src/Toolbar/Toolbar.js","../src/Toolbar/RangeSlider.js","../src/Toolbar/ItemIcon.js","../src/Toolbar/index.js","../src/utils.js","../src/index.js"],"sourcesContent":["import React, { PureComponent } from 'react'\nimport PropTypes from 'prop-types'\n\nexport default class LoadingMask extends PureComponent {\n    render() {\n        const { loading } = this.props\n        if (loading) {\n            return (\n                <div className=\"loading-mask\"><i className=\"loading-mask__icon-loading\" /></div>\n            )\n        }\n        return null\n    }\n}\n\nLoadingMask.defaultProps = {\n    loading: true,\n}\nLoadingMask.propTypes = {\n    loading: PropTypes.bool,\n}\n","import React, { PureComponent } from 'react'\n\nexport default class Toolbar extends PureComponent {\n    render() {\n        const { children } = this.props\n        return (\n            <div className=\"imge-toolbar\">\n                <div className=\"imge-toolbar__actions\">\n                    {children}\n                </div>\n            </div>\n        )\n    }\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nconst RangeSlider = (props) => {\n    const {\n        min, max, value, onChange,\n    } = props\n\n    return (\n        <div className=\"imge-range-slider\">\n            <input\n                onChange={onChange}\n                type=\"range\"\n                min={min}\n                max={max}\n                value={value}\n                className=\"imge-range-slider__input\"\n            />\n            <span className=\"imge-range-slider__text\">{value}</span>\n        </div>\n    )\n}\n\nRangeSlider.defaultProps = {\n    visible: true,\n    min: 0,\n    max: 10,\n    value: 1,\n    onChange: null,\n}\nRangeSlider.propTypes = {\n    visible: PropTypes.bool,\n    min: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    max: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    value: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    onChange: PropTypes.func,\n}\n\nexport default RangeSlider\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nconst ItemIcon = (props) => {\n    const {\n        visible, active, name, onClick,\n        extra, alt, title,\n    } = props\n    if (visible) {\n        return (\n            <span className=\"imge-toolbar-icon__item\">\n                <span\n                    alt={alt}\n                    title={title}\n                    onClick={onClick}\n                    className={`imge-toolbar-icon__wrapper${active ? ' active' : ''}`}\n                >\n                    <i className={`imge-toolbar__icon ${name}`} />\n                </span>\n                {extra}\n            </span>\n        )\n    }\n    return null\n}\n\nItemIcon.defaultProps = {\n    visible: true,\n    active: false,\n    name: '',\n    onClick: null,\n}\nItemIcon.propTypes = {\n    visible: PropTypes.bool,\n    active: PropTypes.bool,\n    name: PropTypes.string,\n    onClick: PropTypes.func,\n}\n\nexport default ItemIcon\n","import React from 'react'\nimport Toolbar from './Toolbar'\nimport RangeSlider from './RangeSlider'\nimport ItemIcon from './ItemIcon'\nimport './index.scss'\n\nconst Split = () => (<span className=\"imge-toolbar__split\" />)\n\nconst TogglePanel = props => (\n    <div className=\"imge-toolbar-sub-panel\" style={{ display: props.visible ? 'block' : 'none' }}>\n        {props.children}\n    </div>\n)\n\nexport { Split, ItemIcon, TogglePanel, RangeSlider }\nexport default Toolbar\n","/**\n * 绘图 操作相关\n */\n\n/**\n * Mosaic 处理\n */\nconst MOSAIC_PEN_LEN = 20\n\nconst drawRect = (ctx, x, y, width, height, fillStyle, lineWidth, strokeStyle, globalAlpha) => {\n    const context = ctx\n    context.beginPath()\n    context.rect(x, y, width, height)\n    context.lineWidth = lineWidth\n    context.strokeStyle = strokeStyle\n    fillStyle && (context.fillStyle = fillStyle)\n    globalAlpha && (context.globalAlpha = globalAlpha)\n\n    context.fill()\n    context.stroke()\n}\nconst setColor = (content, x, y, penLen) => {\n    const ctx = content\n    const imgData = ctx.getImageData(x, y, penLen, penLen).data\n    let r = 0\n    let g = 0\n    let b = 0\n    for (let i = 0; i < imgData.length; i += 4) {\n        r += imgData[i]\n        g += imgData[i + 1]\n        b += imgData[i + 2]\n    }\n    r = Math.round(r / (imgData.length / 4))\n    g = Math.round(g / (imgData.length / 4))\n    b = Math.round(b / (imgData.length / 4))\n    drawRect(ctx, x, y, penLen, penLen, `rgb(${r}, ${g}, ${b})`, 2, `rgb(${r}, ${g}, ${b})`)\n}\n/**\n * 指定路径绘制马赛克\n * @param {CanvasRenderingContext2D} context Canvas 2d Context\n * @param {int} beginX 起点X坐标\n * @param {*} beginY 起点Y坐标\n * @param {*} rectWidth 延伸宽度\n * @param {*} rectHight 眼神高度\n * @param {*} penLen 画笔大小\n */\nconst makeMosaicGrid = (context, beginX, beginY, rectWidth, rectHight, penLen = MOSAIC_PEN_LEN) => {\n    const row = Math.round(rectWidth / penLen) + 1\n    const column = Math.round(rectHight / penLen) + 1\n    for (let i = 0; i < row * column; i += 1) {\n        const x = (i % row) * penLen + beginX\n        const y = parseInt(i / row, 10) * penLen + beginY\n        setColor(context, x, y, penLen)\n    }\n}\n\n/**\n * ---- Canvas操作\n */\n\n/**\n * 文件导出\n */\nconst saveFile = (data, filename) => {\n    const saveLink = document.createElementNS('http://www.w3.org/1999/xhtml', 'a')\n    saveLink.href = data\n    saveLink.download = filename\n\n    const event = document.createEvent('MouseEvents')\n    event.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null)\n    saveLink.dispatchEvent(event)\n}\nconst convertRang = (value, min, max, defaultValue) => {\n    const preValue = parseFloat(value)\n    if (preValue > min && preValue < max) {\n        return preValue\n    }\n    return defaultValue\n}\n/**\n * 导出jpg图片到本地\n * @param {HTMLCanvasElement} canvas Canvas\n * @param {int} quality 图片质量（0-1）\n */\nconst toJpg = (canvas, filename = `${(new Date()).getTime()}.jpg`, quality) => {\n    let imgData = canvas.toDataURL('image/jpeg', convertRang(quality, 0, 1, 0.92))\n    imgData = imgData.replace('image/jpeg', 'image/octet-stream')\n    saveFile(imgData, filename)\n}\n/**\n * 导出png图片到本地\n * @param {HTMLCanvasElement} canvas Canvas\n * @param {int} quality 图片质量（0-1）\n */\nconst toPng = (canvas, filename = `${(new Date()).getTime()}.jpg`, quality) => {\n    let imgData = canvas.toDataURL('image/png', convertRang(quality, 0, 1, 0.92))\n    imgData = imgData.replace('image/png', 'image/octet-stream')\n    saveFile(imgData, filename)\n}\n/**\n * canvas图像内容向右侧旋转90º\n * --- 目前该方法是利用Image旋转，是存在性能问题的\n *\n * @param {HTMLCanvasElement} canvas Canvas对象\n * @param {Function} callback 旋转结束之后的回掉函数\n */\n\n/**\n * 顺时针旋转 Canvas 的ImageData 90度\n * @param {HTMLCanvasElement} canvas Canvas\n */\nconst rotateImageDataR90 = (canvas) => {\n    const context = canvas.getContext('2d')\n    const iData = context.getImageData(0,0,canvas.width, canvas.height)\n    const W = canvas.width\n    const H = canvas.height\n    const newData = []\n    for(let i=0; i< iData.data.length; i+=4){\n        const X = i % (W*4)\n        const Y = parseInt(i/(W*4))\n        const newIndex = H*X+(H-1-Y)*4\n\n        newData[newIndex] = iData.data[i]\n        newData[newIndex+1] = iData.data[i+1]\n        newData[newIndex+2] = iData.data[i+2]\n        newData[newIndex+3] = iData.data[i+3]\n    }\n    const newImgData = context.createImageData(H, W);\n\n    for (let index = 0; index < iData.data.length; index++) {\n        newImgData.data[index] = newData[index]\n    }\n    return newImgData\n}\n\n/**\n * 顺时针旋转canvas\n * @param {HTMLCanvasElement} canvas Canvas\n */\nconst rotateCanvasR90 = (canvas) => {\n    const imageData = rotateImageDataR90(canvas)\n    canvas.width = imageData.width\n    canvas.height = imageData.height\n    const context = canvas.getContext('2d')\n    context.putImageData(imageData, 0 ,0)\n}\n\n/**\n * ---- Element Html元素操作\n */\n\n/**\n * 缩放元素\n * @param {HTMLElement} wrapper 要操作的元素节点\n * @param {Number} originWidth 原始宽度\n * @param {Number} originHeight 原始高度\n * @param {Number} zoomLevel 放大倍数\n * @param {Number} max 放大后最小边的最大值\n * @param {Number} min 缩小后最大边的最小值\n */\nconst zoom = (element, originWidth, originHeight, zoomLevel, max = 20000, min = 4) => {\n    const cWrapper = element\n    if (!cWrapper) return\n    // 图片缩放比例是相对于原始宽度\n    const newWidth = zoomLevel * originWidth\n    const newHeight = zoomLevel * originHeight\n\n    // 边界判断\n    if (max && Math.min(newWidth, newHeight) > max) {\n        window.console.info('图片过大')\n        return\n    } else if (min && Math.max(newWidth, newHeight) < min) {\n        window.console.info('图片过小')\n        return\n    }\n\n    // 缩放后，根据图片现有位置，处理中心点位置偏移\n    const offsetTop = (cWrapper.clientHeight - newHeight) / 2\n    const offsetLeft = (cWrapper.clientWidth - newWidth) / 2\n    if (cWrapper.style) {\n        cWrapper.style.width = `${newWidth}px`\n        cWrapper.style.height = `${newHeight}px`\n        cWrapper.style.top = `${cWrapper.offsetTop + offsetTop}px`\n        cWrapper.style.left = `${cWrapper.offsetLeft + offsetLeft}px`\n    } else {\n        window.console.warn('Element Has No Style ?')\n    }\n}\n\n/**\n * 缩放element元素到最合适的比例显示在目标容器中\n * @param {HTMLElement} element 要处理缩放的html元素\n * @param {Number} originWidth 原始内容宽度\n * @param {Number} originHeight 原始内容高度\n * @param {Number} targetWidth 目标容器的宽度\n * @param {Number} targetHeight 目标容器的高度\n * @return {Number} 最终的缩放比例值\n */\nconst zoomToFit = (element, originWidth, originHeight, targetWidth, targetHeight) => {\n    if (!element || !element || !originWidth || !originHeight || !targetWidth || !targetHeight) {\n        window.console.warn('Data is not fit')\n        return NaN\n    }\n    // 比较宽度，默认最适合目标容器的大小\n    const cWrapper = element\n    const minWidth = Math.min(targetWidth, originWidth)\n    const minHeight = Math.min(targetHeight, originHeight)\n    let destWidth = 0\n    let destHeight = 0\n    if (originWidth > originHeight) {\n        destWidth = minWidth\n        destHeight = destWidth / originWidth * originHeight\n    } else {\n        destHeight = minHeight\n        destWidth = destHeight / originHeight * originWidth\n    }\n    // 设置图片居中显示, 画布容器进行缩放\n    cWrapper.style.width = `${destWidth}px`\n    cWrapper.style.height = `${destHeight}px`\n    cWrapper.style.top = `${(targetHeight - destHeight) / 2}px`\n    cWrapper.style.left = `${(targetWidth - destWidth) / 2}px`\n\n    return destWidth / originWidth\n}\nconst rotateElementR90 = (element) => {\n    const value = element.style.transform.match(/\\d+/)\n    let deg = 90\n    if (Array.isArray(value)) {\n        deg = parseInt(value[0]) + 90\n    }\n    const rotateStr = `rotate(${deg}deg)`\n    element.style.transform = rotateStr\n    element.style['-ms-transform'] = rotateStr\n}\n\nexport const Element = {\n    zoom,\n    zoomToFit,\n    rotateR90: rotateElementR90,\n}\nexport const Canvas = {\n    rotateR90: rotateCanvasR90\n}\nexport const Mosaic = {\n    makeMosaicGrid,\n}\nexport const Export = {\n    toJpg,\n    toPng,\n}\n","import React, { Component, PureComponent, Fragment } from 'react'\nimport PropTypes from 'prop-types'\nimport LoadingMask from './LoadingMask'\nimport Toolbar, { RangeSlider, ItemIcon, Split, TogglePanel } from './Toolbar'\nimport { Canvas, Mosaic, Export, Element } from './utils'\nimport './index.scss'\n\nclass ImageEditor extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            visible: !!props.visible,\n            loading: true,\n            zoomLevel: 1,\n            editable: false,\n            penSize: 20,\n        }\n        this.imageOrigin = null\n\n        // 画板拖动相关\n        this.dragStartX = 0\n        this.dragStartY = 0\n    }\n\n    componentDidMount() {\n        this.props.data && this.loadData(this.props.data)\n    }\n\n    componentWillReceiveProps(nextProps) {\n        if ('visible' in nextProps) {\n            if (this.state.visible !== nextProps.visible) {\n                this.setState({\n                    visible: nextProps.visible,\n                })\n                // 当props切换时候，只有当 visible 显示时候，data的变化才有意义\n                if (nextProps.visible && 'data' in nextProps) {\n                    this.loadData(nextProps.data)\n                }\n            }\n        }\n    }\n\n    componentWillUnmount() {\n        this.toggleMoveable(false)\n    }\n\n    onModalClose = () => {\n        const { editable } = this.state\n        if ((editable && window.confirm('确认关闭吗？')) || !editable) {\n            const { onClose } = this.props\n\n            // 处理关闭后相关操作\n            this.resetToolbar({ editable: false })\n            this.toggleMoveable(false)\n            this.imageOrigin = null\n\n            onClose && onClose()\n        }\n    }\n\n    // 画布容器拖动事件 -------\n    onCanvasEditorMouseDown = (event) => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.dragMoving = true\n        this.dragStartX = event.clientX - this.canvasWrapper.offsetLeft\n        this.dragStartY = event.clientY - this.canvasWrapper.offsetTop\n    }\n    onCanvasEditorMouseMove = (event) => {\n        if (this.dragMoving) {\n            this.canvasWrapper.style.left = `${event.clientX - this.dragStartX}px`\n            this.canvasWrapper.style.top = `${event.clientY - this.dragStartY}px`\n        }\n    }\n    onCanvasEditorMouseUp = () => {\n        this.dragMoving = false\n        this.dragStartX = 0\n        this.dragStartY = 0\n    }\n    // ------- 画布容器拖动事件\n\n    // 打码操作事件 -------\n    onMosaicMouseDown = (event) => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.mosaicMaking = true\n        this.mosaicStartX = event.offsetX\n        this.mosaicStartY = event.offsetY\n    }\n\n    onMosaicMouseMove = (event) => {\n        if (this.mosaicMaking) {\n            const { penSize } = this.state\n            const zoomLevel = this.canvasWrapper.clientWidth / this.canvas.width\n            const startX = (this.mosaicStartX / zoomLevel)\n            const startY = (this.mosaicStartY / zoomLevel)\n            const endX = (event.offsetX / zoomLevel)\n            const endY = (event.offsetY / zoomLevel)\n            Mosaic.makeMosaicGrid(this.canvas.getContext('2d'), startX, startY, endX - startX, endY - startY, penSize)\n            this.mosaicStartX = event.offsetX\n            this.mosaicStartY = event.offsetY\n        }\n    }\n    onMosaicMouseUp = () => {\n        this.mosaicMaking = false\n    }\n    // ------- 打码操作事件\n\n    // ------- 图片加载\n    onImageLoad = () => {\n        if (!this.imageOrigin || !this.canvas) return\n        const img = this.imageOrigin\n        this.canvas.width = img.width\n        this.canvas.height = img.height\n        const context = this.canvas.getContext('2d')\n        context.drawImage(img, 0, 0, img.width, img.height)\n        this.zoomToFit()\n        this.setState({ loading: false })\n        this.toggleMoveable(true)\n    }\n    loadData = (data) => {\n        if (!data) { console.log('image Data is empty'); return }\n        this.setState({ loading: true })\n\n        this.imageOrigin = new Image()\n        this.imageOrigin.crossOrigin = 'anonymous'\n        this.imageOrigin.src = data\n        this.imageOrigin.onload = this.onImageLoad\n    }\n    // ------- 图片加载\n\n\n    // Toolbar 操作事件\n    makeEditable = () => {\n        this.setState({\n            editable: true,\n        })\n    }\n    makeMosaic = () => {\n        const { isMosaic } = this.state\n        this.canvas.onmousedown = isMosaic ? null : this.onMosaicMouseDown\n        this.canvas.onmousemove = isMosaic ? null : this.onMosaicMouseMove\n        this.canvas.onmouseup = isMosaic ? null : this.onMosaicMouseUp\n        this.canvas.onmouseleave = isMosaic ? null : this.onMosaicMouseUp\n        this.resetToolbar({ isMosaic: !isMosaic })\n    }\n    toggleMoveable = (moveable) => {\n        if (this.editor) {\n            const op = moveable ? 'addEventListener' : 'removeEventListener'\n            this.editor[op]('mousedown', this.onCanvasEditorMouseDown)\n            this.editor[op]('mousemove', this.onCanvasEditorMouseMove)\n            this.editor[op]('mouseup', this.onCanvasEditorMouseUp)\n            this.editor[op]('mouseleave', this.onCanvasEditorMouseUp)\n            this.setState({ moveable })\n        }\n    }\n\n    zoomIn = () => {\n        console.log('放大')\n        const { zoomLevel } = this.state\n        this.zoomTo(zoomLevel * 1.2)\n    }\n    zoomOut = () => {\n        console.log('缩小')\n        const { zoomLevel } = this.state\n        this.zoomTo(zoomLevel * 0.8)\n    }\n    zoomToFit = () => {\n        const zoomLevel = Element.zoomToFit(\n            this.canvasWrapper,\n            this.canvas.width,\n            this.canvas.height,\n            this.editor.clientWidth,\n            this.editor.clientHeight,\n        )\n        this.setState({ zoomLevel })\n    }\n    zoomTo = (zoomLevel) => {\n        Element.zoom(this.canvasWrapper, this.canvas.width, this.canvas.height, zoomLevel)\n        this.setState({ zoomLevel })\n    }\n\n    // 右旋转90度\n    rotateCanvasDom = () => {\n        Element.rotateR90(this.canvas)\n    }\n    rotateImage = () => {\n        const { rotating } = this.state\n        if (rotating) { return }\n        this.setState({ rotating: true })\n\n        Canvas.rotateR90(this.canvas)\n        // 旋转之后处理画布的大小\n        const newWidth = this.canvasWrapper.clientHeight\n        const newHeight = this.canvasWrapper.clientWidth\n        const cwOffsetLeft = this.canvasWrapper.offsetLeft\n        const cwOffsetTop = this.canvasWrapper.offsetTop\n        this.canvasWrapper.style.width = `${newWidth}px`\n        this.canvasWrapper.style.height = `${newHeight}px`\n        this.canvasWrapper.style.top = `${cwOffsetTop + (newWidth - newHeight) / 2}px`\n        this.canvasWrapper.style.left = `${cwOffsetLeft + (newHeight - newWidth) / 2}px`\n\n        this.setState({ rotating: false })\n    }\n    // 撤销\n    restore = () => {\n        this.imageOrigin.src = this.props.data\n    }\n    // 重设编辑条按钮状态\n    resetToolbar = (value) => {\n        this.setState({\n            isMosaic: false,\n            ...value,\n        })\n    }\n    save = () => {\n        const { onSaveDataURL } = this.props\n        if (typeof onSaveDataURL === 'function') {\n            onSaveDataURL(this.canvas && this.canvas.toDataURL())\n        }\n        this.setState({\n            editable: false,\n        })\n    }\n    downloadJpg = () => {\n        Export.toJpg(this.canvas)\n    }\n    onPenSizeChange = (event) => {\n        this.setState({\n            penSize: event.target.value,\n        })\n    }\n\n    render() {\n        const {\n            visible, loading, editable, isMosaic, moveable,\n            penSize,\n        } = this.state\n        if (!visible) { return null }\n\n        return (\n            <div className=\"image-editor\">\n                <div className=\"imge-wrapper\">\n                    <Toolbar>\n                        <ItemIcon onClick={this.zoomIn} name=\"icon-zoom-in\" title=\"放大\" />\n                        <ItemIcon onClick={this.zoomOut} name=\"icon-zoom-out\" title=\"缩小\" />\n                        <ItemIcon onClick={this.zoomToFit} name=\"icon-zoom-fit\" title=\"适合窗口\" />\n                        <ItemIcon visible={!editable} onClick={this.rotateCanvasDom} name=\"icon-rotate-right\" title=\"旋转画布\" />\n                        <Split />\n                        <ItemIcon visible={editable} onClick={this.restore} name=\"icon-restore\" title=\"清除所有更改\" />\n                        <ItemIcon\n                            active={isMosaic}\n                            visible={editable}\n                            name=\"icon-mosaic\"\n                            onClick={this.makeMosaic}\n                            title=\"马赛克\"\n                            extra={\n                                <TogglePanel visible={isMosaic}>\n                                    <RangeSlider onChange={this.onPenSizeChange} min={10} max={200} value={penSize} />\n                                </TogglePanel>\n                            }\n                        />\n                        <ItemIcon visible={editable} onClick={this.downloadJpg} name=\"icon-download\" title=\"导出Jpg图片\" />\n                        <ItemIcon visible={editable} onClick={this.rotateImage} name=\"icon-rotate-right\" title=\"旋转图片(修改)\" />\n                        <ItemIcon visible={!editable} onClick={this.makeEditable} name=\"icon-edit\" title=\"编辑图片\" />\n                        <ItemIcon visible={editable} onClick={this.save} name=\"icon-check\" title=\"保存\" />\n                        <Split />\n                        <span onClick={this.onModalClose}><ItemIcon name=\"icon-close\" title=\"关闭\" /></span>\n                    </Toolbar>\n                    <div className=\"imge-container\" ref={(ref) => { this.editor = ref }}>\n                        <LoadingMask loading={loading} />\n                        <div\n                            ref={(ref) => { this.canvasWrapper = ref }}\n                            className=\"canvas-wrapper\"\n                        >\n                            <canvas ref={(ref) => { this.canvas = ref }}>您的浏览器不支持canvas</canvas>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\nImageEditor.propTypes = {\n    onClose: PropTypes.func,\n    onSaveDataURL: PropTypes.func,\n    data: PropTypes.string,\n}\nImageEditor.defaultProps = {\n    onClose: null,\n    onSaveDataURL: null,\n    data: null,\n}\n\nexport default ImageEditor\n"],"names":["LoadingMask","render","loading","props","PureComponent","defaultProps","Toolbar","children","RangeSlider","min","max","value","onChange","ItemIcon","visible","active","name","onClick","extra","alt","title","Split","TogglePanel","display","MOSAIC_PEN_LEN","drawRect","ctx","x","y","width","height","fillStyle","lineWidth","strokeStyle","globalAlpha","context","beginPath","rect","fill","stroke","setColor","content","penLen","imgData","getImageData","data","r","g","b","i","length","Math","round","makeMosaicGrid","beginX","beginY","rectWidth","rectHight","row","column","parseInt","saveFile","filename","saveLink","document","createElementNS","href","download","event","createEvent","initMouseEvent","window","dispatchEvent","convertRang","defaultValue","preValue","parseFloat","toJpg","canvas","Date","getTime","quality","toDataURL","replace","toPng","rotateImageDataR90","getContext","iData","W","H","newData","X","Y","newIndex","newImgData","createImageData","index","rotateCanvasR90","imageData","putImageData","zoom","element","originWidth","originHeight","zoomLevel","cWrapper","newWidth","newHeight","console","info","offsetTop","clientHeight","offsetLeft","clientWidth","style","top","left","warn","zoomToFit","targetWidth","targetHeight","NaN","minWidth","minHeight","destWidth","destHeight","rotateElementR90","transform","match","deg","Array","isArray","rotateStr","Element","Canvas","Mosaic","Export","ImageEditor","onModalClose","editable","state","confirm","onClose","resetToolbar","toggleMoveable","imageOrigin","onCanvasEditorMouseDown","preventDefault","stopPropagation","dragMoving","dragStartX","clientX","canvasWrapper","dragStartY","clientY","onCanvasEditorMouseMove","onCanvasEditorMouseUp","onMosaicMouseDown","mosaicMaking","mosaicStartX","offsetX","mosaicStartY","offsetY","onMosaicMouseMove","penSize","startX","startY","endX","endY","onMosaicMouseUp","onImageLoad","img","drawImage","setState","loadData","log","Image","crossOrigin","src","onload","makeEditable","makeMosaic","isMosaic","onmousedown","onmousemove","onmouseup","onmouseleave","moveable","editor","op","zoomIn","zoomTo","zoomOut","rotateCanvasDom","rotateR90","rotateImage","rotating","cwOffsetLeft","cwOffsetTop","restore","save","onSaveDataURL","downloadJpg","onPenSizeChange","target","componentDidMount","componentWillReceiveProps","nextProps","componentWillUnmount","React","ref","Component"],"mappings":"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"}